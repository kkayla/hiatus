<h1>Home#index</h1>
<p>Find me in app/views/home/index.html.erb</p>
<strong>life is a beach </strong>

<button onclick="getLocation()">Try It</button>
<p id="demo"></p>

<%= form_tag "/search" do %>
  <%= text_field_2tag :query %>
  <%= hidden_field_tag :coords,nil,{id: "yo-mama"} %>
  <!-- ^we are taking the coords from the mif dpoms -->
  <%= submit_tag %>
<% end %>
<%= @results[1] if @results %>

<div id="map"></div>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAL3tGbNJnkQPnEp5KRfIUi-TOJ6-LWZ0I&callback=initMap">
// ^async lets the broswer render the rest of the webiste while the Maps API loads. when the blessed api is ready, it calls the function specified using the callback which is: "initMap"
</script>
<script>
var x = document.getElementById("demo");

function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.watchPosition(showPosition);
    } else {
        x.innerHTML = "Geolocation is not supported by this browser.";
    }
}
function showPosition(position) {
    x.innerHTML = position.coords.latitude + ", "
    + position.coords.longitude;
    document.getElementById('yo-mama').value = position.coords.latitude + ", "
    + position.coords.longitude;
}

</script>
<script>
function initMap() {
  var map = new google.maps.Map(document.getElementById('map'), {
    center: {lat: <%=@results[1]['pos'].split(',')[0] if @results%>,
            lng: <%=@results[1]['pos'].split(',')[1] if @results%>},
    zoom: 14
  });
}
</script>
</body>
</html>
